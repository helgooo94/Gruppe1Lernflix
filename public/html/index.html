<!doctype html>
<html lang="en">

<head>
    <script>
        //PARAMS**GO**HERE
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Lernflix web application - streaming LMS videos together">
    <meta name="generator" content="Hugo 0.80.0">
    <title>Lernflix</title>

    <!-- Jquery.js -->
    <script src="../assets/jquery/jquery.js"></script>

    <!-- Bootstrap core CSS / JS -->
    <link rel="stylesheet" href="../css/bootstrap.css">
    <script src="../assets/bootstrap/bootstrap.js"></script>
    <!-- icon bar css-->
    <link rel="stylesheet" href="../assets/icons/icon-bar.css">
    <!-- font-icons css-->
    <link rel="stylesheet" href="../assets/icons/font-icons.css">

    <!--  <link rel="stylesheet" href="../css/main.css">-->
    <link rel="stylesheet" href="../css/less/chat.css">
    <link rel="stylesheet" href="../css/less/controls.css">
    <link rel="stylesheet" href="../css/less/navigation.css">
    <link rel="stylesheet" href="../css/less/style.css">
    <link rel="stylesheet" href="../css/less/video.css">
    <link rel="stylesheet" href="../css/less/room.css">

    <script src="/socket.io/socket.io.js"></script>


    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

    <!-- Video Functions-->
    <script>
        /*
                                                                                                                var flagID = 0;

                                                                                                                $(document).ready(function() {
                                                                                                                    //get popup_content // Input und Button
                                                                                                                    var popup_content = $("#pop_cont")

                                                                                                                    tippy('#setFlag', {
                                                                                                                        content: popup_content.html(),
                                                                                                                        trigger: 'click',
                                                                                                                        hideOnClick: true,
                                                                                                                        allowHTML: true,
                                                                                                                        interactive: true,

                                                                                                                    });

                                                                                                                    //Zeit wird bei Klick auf Flag genommen und an FlagVideo als Parameter weitergegeben. Grund: Kommentare zu schreiben benötigt Zeit
                                                                                                                    //während man Kommentar schreibt läuft Video weiter --> Flag wäre nicht mehr Zeitgenau. 
                                                                                                                    $("#setFlag").click(function() {
                                                                                                                        var curTime = Math.floor(video1.currentTime);
                                                                                                                        $(".tippy-content > button").attr("onclick", "flagVideo(" + curTime + ")")
                                                                                                                        $(".tippy-content > input").select();

                                                                                                                    })

                                                                                                                    $(document).on("click", ".videoElement", function() {
                                                                                                                        var NewVideoUrl = $(this).attr("data-url");
                                                                                                                        changeVideo(NewVideoUrl)
                                                                                                                    })

                                                                                                                    //Lädt alle Videos in das Modal
                                                                                                                    $.ajax({
                                                                                                                        url: '../assets/opencastAPI.json',
                                                                                                                        type: "GET",
                                                                                                                        dataType: 'JSON',
                                                                                                                        success: function(data) {
                                                                                                                            $.each(data["search-results"].result, function(i, item) {
                                                                                                                                var video_thumbnail = item['mediapackage']['attachments']['attachment'][2]['url']
                                                                                                                                var video_title = item['mediapackage']['title']
                                                                                                                                var video_res480p = item['mediapackage']['media']['track'][0]['url']
                                                                                                                                    //            var video_res720p = data['search-results']['result'][0]['mediapackage']['media']['track'][2]['url']
                                                                                                                                    //            var video_res1080p = data['search-results']['result'][0]['mediapackage']['media']['track'][1]['url']
                                                                                                                                $(".videolist").append("<div tabindex ='-1' id='videoElement" + i + "' class='videoElement py-3 fadein' data-url=" + video_res480p + "><img class='videoThumbnail col-6' src=" + video_thumbnail + "/><h1 class='videoTitle col-6 px-3'>" + video_title + "</h1></div>");

                                                                                                                            })
                                                                                                                        }

                                                                                                                    });
                                                                                                                });

                                                                                                                //startet Video
                                                                                                                function startVideo() {
                                                                                                                    $("#video1").trigger("play");
                                                                                                                }
                                                                                                                //pausiert Video
                                                                                                                function stopVideo() {
                                                                                                                    $("#video1").trigger("pause");
                                                                                                                }
                                                                                                                //lädt das Video neu
                                                                                                                function resetVideo() {
                                                                                                                    $("#video1").trigger("load");
                                                                                                                }



                                                                                                                //setzt eine "Flagge" bzw. Makiert 
                                                                                                                function flagVideo(curTime) {

                                                                                                                    flagID++
                                                                                                                    //gets Video from Dom
                                                                                                                    var vid = document.getElementById("video1");
                                                                                                                    //gets current Time of selected Video

                                                                                                                    //gets input.value
                                                                                                                    var popup_input = $(".tippy-content > input")
                                                                                                                    var input_text = popup_input.val();

                                                                                                                    //formats Seconds into HH:MM:SS
                                                                                                                    var date = new Date(0);
                                                                                                                    date.setSeconds(curTime); // specify value for SECONDS here
                                                                                                                    var timeString = date.toISOString().substr(11, 8);

                                                                                                                    //erstellt ein Element mit unique ID und setzt parameter zu JumpVideo direkt ein.
                                                                                                                    $("#flag").append("<p onclick='jumpVideo(" + curTime + ")'id=flagID_" + flagID + ">Time: " + timeString + "<br/>Message:  " + input_text);
                                                                                                                    popup_input.val('');


                                                                                                                }

                                                                                                                //springt zu bestimmter Sekunde im Video
                                                                                                                function jumpVideo(seconds) {
                                                                                                                    var vid = document.getElementById("video1");
                                                                                                                    vid.currentTime = seconds;
                                                                                                                }
                                                                                                                
                                                                                                                        function changeVideo(url) {
                                                                                                                            var currentVideo = $("#video1")
                                                                                                                            currentVideo.attr("src", url)

                                                                                                                        }*/
    </script>




</head>

<body id="body">

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Neuen Raum Anlegen</h5>
                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="recipient-name" class="col-form-label">Raumname:</label>
                        <input type="text" class="form-control" id="recipient-name">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                <!-- Bei "Raum Anlegen" muss saveRooms() + die joinRooms() Funktion getriggert werden + die Value von id "recupient-name" (name ggfs noch ändern) mitgeschickt werden + die zufälle id (die zufällige zahl von 1 bis ne milliarde oder was du gemacht hast) -->
                <button type="button" class="btn btn-primary">Raum anlegen</button>
            </div>
        </div>
    </div>
</div>


<!--*************+START*************-->
<!--********************************-->
<!--***********Navigation***********-->
<script>
    $(document).ready(function() {
      $("#profileName").text(`${params.username}`);
      $("#profileImg").attr("src", `${params.url_picture}`);
    });
  </script>

<!-- Search function -->
<script>
  $(document).ready(function(){
  $("#searchRooms").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#rooms button").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
  </script>
<input type="text" id="createRoomInputTextField" value="Some text...">
<button type="button" class="btn btn-primary" onclick="createRoom()">Raum erstellen</button>
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@getbootstrap">Raum Anlegen</button>

<header>
    <div class="navbar navbar-dark bg-dark shadow-sm ">
        <div class="container">
            <div class="logo">
                <a class="navbar-brand d-flex align-items-center">
                    <div class="profileInfo">
                        <img style="margin-right:10px"  src="../assets/illustrations/111111.png" />
                        <div class="">
                    <strong>Lernflix</strong>

                        </div>
                    </div>
                </a>
            </div>
            <div class="search_room dropdown ">
                <input class="form-control dropdown-toggle" type="text" placeholder="Suchen sie ein Moodle raum aus" id="searchRooms" data-bs-toggle="dropdown" aria-expanded="false" onclick="selectRoom()">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit" onclick="callJoinRoom()">Search</button>
                <div id="rooms" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <button class="dropdown-item" type="button">Action</button>
                    <button id="531514655"   class="dropdown-item" type="button">TESSSSSSSSSSSST</button>
                    <button id="499078358"   class="dropdown-item" type="button">TEEEEEEEEEEEST2</button>

                </div>
            </div>
            <div class="profileInfo">
                <img id="profileImg" src="../assets/illustrations/error404_2.png" />
                <div class="">
                    <p id="profileName">&nbsp;</p>
                    <a href="#">
                        <p>Logout</p>
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<!--********************************-->
<!--***********Navigation***********-->
<!--**************END***************-->


<main>

    <section>
        <div class="py-3 container">
            <div class="row rooms">
                <input class="form-control" type="text" placeholder="Moodle" id="createRooms">
                <button type="button" class="btn btn-outline-dark" onclick="createRoom()">Raum erstellen</button>
                <button type="button" class="btn btn-outline-dark" data-toggle="modal" data-target="#exampleModal" data-whatever="@getbootstrap">Raum Anlegen</button>
            </div>
        </div>
    </section>


    <section>
        <div class="py-2 container">
            <div class="row py-lg-5">
                <div class="col-md-8 themed-grid-col">
                    <div class="videoplayer">
                        <h2>Video Title</h2>
                        <video width="854" height="480" controls class="vid-fluid" id="videoplayer" src="" >
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <input id="seekslider" type="range" min="0" max="100" value="0" step="1" style="width: 400 px;">
                    <span id="videoplayerTimeText">0:00/0:00</span>
                    <input id="volumeControl" type="range" min="0" max="100" step="1" oninput="setVolume(this.value)" onchange="setVolume(this.value)">
                    <div class="col-md-12 py-4">
                        <button id="start" class="btn btn-lg hover-top btn-glow" onclick="playVideo()">Play</button>
                        <button id="pause" class="btn btn-lg  hover-top btn-glow" onclick="pauseVideo()">Pause</button>
                        <button id="setFlag" class="btn btn-lg hover-top btn-glow">Flag</button>
                        <button id="addVideo" type="button" class="btn btn-primary" data-toggle="modal" data-target="#listvideos">Add Video to Queue</button>

                        <div class="popup_content" id="pop_cont">
                            <input type="text">
                            <button id="" onclick="flagVideo()" type="button" class="btn btn-primary btn-sm">Small button</button>
                        </div>
                    </div>
                    <div id="flag">
                        <p>Flagged Time:</p>
                    </div>
                </div>
                <div class="col-md-4 themed-grid-col">
                    <a></a>
                    <div class="chat-container">
                        <header class="chat-header">
                            <h2> Chat</h2>
                        </header>
                        <main class="chat-main">

                            <div class="chat-messages">
                            </div>
                        </main>
                        <div class="chat-form-container">
                            <form id="chat-form">
                                <input id="msg" type="text" placeholder="Nachricht eingeben" required autocomplete="off" />
                                <button class="btn"><i class="fas fa-paper-plane"></i> Send</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Modal -->
    <div class="modal fade" id="listvideos" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Alle Videos</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body container">
                    <div class="row">
                        <div class="col-12 videolist">
                            <button type="button" class="btn btn-secondary" onclick="changeVideo(`https://opencast-engage.hs-rw.de/static/mh_default_org/engage-player/26316efa-efa8-4906-b9c4-2ef5d1a613a3/17fe9ed6-72f1-4024-848b-85af5104e30d/_.mp4`)">Video 1 - Hasen</button>
                            <button type="button" class="btn btn-secondary" onclick="changeVideo(`https://opencast-engage.hs-rw.de/static/mh_default_org/api/8531fc76-4876-4113-b36a-d47e822ceb70/03a1670b-d5ca-41f6-8a29-7ca5a387efac/_.mp4`)">Video 2 - Python</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="changeVideo()">Add Video</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal end-->

</main>
<!--  Hier statt CDN die .js Dateien runterladen und verlinkung anpassen-->
<script src="https://unpkg.com/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.js"></script>
<script src="../js/main.js"></script>
</body>

</html>